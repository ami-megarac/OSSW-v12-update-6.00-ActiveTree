diff -Naur linux_ori/include/net/ipv6.h linux/include/net/ipv6.h
--- linux_ori/include/net/ipv6.h	2023-03-13 17:18:25.000000000 +0800
+++ linux/include/net/ipv6.h	2023-10-20 17:05:32.990226442 +0800
@@ -660,12 +660,8 @@
 /* more secured version of ipv6_addr_hash() */
 static inline u32 __ipv6_addr_jhash(const struct in6_addr *a, const u32 initval)
 {
-	u32 v = (__force u32)a->s6_addr32[0] ^ (__force u32)a->s6_addr32[1];
-
-	return jhash_3words(v,
-			    (__force u32)a->s6_addr32[2],
-			    (__force u32)a->s6_addr32[3],
-			    initval);
+	return jhash2((__force const u32 *)a->s6_addr32,
+		      ARRAY_SIZE(a->s6_addr32), initval);
 }
 
 static inline bool ipv6_addr_loopback(const struct in6_addr *a)
