diff -Naru linux_origin/fs/exec.c linux/fs/exec.c
--- linux_origin/fs/exec.c	2022-03-15 15:21:51.716018784 +0800
+++ linux/fs/exec.c	2022-03-15 15:22:37.518748567 +0800
@@ -988,7 +988,7 @@
 	struct fd f = fdget(fd);
 	int ret = -EBADF;
 
-	if (!f.file)
+	if (!f.file || !(f.file->f_mode & FMODE_READ))
 		goto out;
 
 	ret = kernel_read_file(f.file, buf, size, max_size, id);
