diff -Naur linux_ori/fs/overlayfs/copy_up.c linux/fs/overlayfs/copy_up.c
--- linux_ori/fs/overlayfs/copy_up.c	2023-03-13 17:18:25.000000000 +0800
+++ linux/fs/overlayfs/copy_up.c	2023-09-19 15:06:03.646196133 +0800
@@ -805,6 +805,10 @@
 			  STATX_BASIC_STATS, AT_STATX_SYNC_AS_STAT);
 	if (err)
 		return err;
+		
+	if (!kuid_has_mapping(current_user_ns(), ctx.stat.uid) ||
+	    !kgid_has_mapping(current_user_ns(), ctx.stat.gid))
+		return -EOVERFLOW;
 
 	ctx.metacopy = ovl_need_meta_copy_up(dentry, ctx.stat.mode, flags);
 
