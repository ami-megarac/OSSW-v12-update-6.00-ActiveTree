diff -Naru linux_origin/drivers/usb/gadget/composite.c linux/drivers/usb/gadget/composite.c
--- linux_origin/drivers/usb/gadget/composite.c	2022-03-15 15:05:01.820020690 +0800
+++ linux/drivers/usb/gadget/composite.c	2022-03-15 15:13:49.261397626 +0800
@@ -1944,6 +1944,9 @@
 				if (w_index != 0x5 || (w_value >> 8))
 					break;
 				interface = w_value & 0xFF;
+				if (interface >= MAX_CONFIG_INTERFACES ||
+				    !os_desc_cfg->interface[interface])
+					break;
 				buf[6] = w_index;
 				count = count_ext_prop(os_desc_cfg,
 					interface);
