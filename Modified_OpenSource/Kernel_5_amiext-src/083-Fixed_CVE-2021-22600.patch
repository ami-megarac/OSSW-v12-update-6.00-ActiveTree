diff -Naru linux_origin/net/packet/af_packet.c linux/net/packet/af_packet.c
--- linux_origin/net/packet/af_packet.c	2022-02-08 15:38:45.922220131 +0800
+++ linux/net/packet/af_packet.c	2022-02-08 15:40:13.593171985 +0800
@@ -4453,9 +4453,10 @@
 	}
 
 out_free_pg_vec:
-	bitmap_free(rx_owner_map);
-	if (pg_vec)
+	if (pg_vec) {
+		bitmap_free(rx_owner_map);
 		free_pg_vec(pg_vec, order, req->tp_block_nr);
+	}
 out:
 	return err;
 }
